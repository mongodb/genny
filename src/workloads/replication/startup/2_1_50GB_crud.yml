SchemaVersion: 2018-07-01
Owner: mongodb/server-replication"
Description: >
  Adds CRUD operations to be replayed during startup recovery for the heavy phase.

Clients:
  Default:
    QueryOptions:
      maxPoolSize: 2500

NumPhases: &max_phase 1
# Should match values in 'src/workloads/replication/startup/2_0_50GB.yml'
Database: &database "startup_50GB"
CollectionCount: &collectionCount 10000

Actors:
- StopCheckpointing:
  LoadConfig:
    Path: "../../../phases/replication/startup/StartupPhasesTemplate.yml"
    Key: StopCheckpointTemplate
    Parameters:
      active: [0]
      nopInPhasesUpTo: *max_phase

- CrudOperations:
  LoadConfig:
    Path: "../../../phases/replication/startup/StartupPhasesTemplate.yml"
    Key: CrudOperationsTemplate
    Parameters:
      active: [1]
      nopInPhasesUpTo: *max_phase
      database: *database
      collectionCount: *collectionCount
      # 1% of the total collection count, keep it low as this also controls the number of threads as
      # each collection will operate in its own thread.
      numOfCollectionsTargeted: 100
      numOfCrudOpsPerCollection: 100000  # ~10M operations in total.

