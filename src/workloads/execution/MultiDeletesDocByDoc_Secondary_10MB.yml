SchemaVersion: 2018-07-01
Owner: "@mongodb/server-execution"
Description: >
  Deletes a large range of documents using the DELETE query exec stage while performing writes on another collection.

# TODO move the Clients section to src/phases/execution/MultiDeletes.yml once TIG-3950 is resolved.
Clients:
  Default:
    QueryOptions:
      # Allow for longer duration since the loading of the data may take a while.
      socketTimeoutMS: 3_600_000  # = 1 hour

LoadConfig:
  Path: "../../phases/execution/MultiDeletes.yml"
  Parameters:
    DocumentSizePaddingBytes: 10485760  # 10MB
    DocumentCount: 1_000
    # Cannot batch insert more than INT_MAX bytes, also no need to batch large docs
    InsertBatchSize: 1
    ConfigurationFile: "../../phases/execution/config/MultiDeletes/WithSecondaryIndexes.yml"

AutoRun:
- When:
    mongodb_setup:
      $eq:
      - replica-all-feature-flags
